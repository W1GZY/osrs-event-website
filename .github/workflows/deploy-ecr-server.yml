name: Deploy OSRSEvent Server to ECR

on:
  push:
    branches: [ master ]

jobs:

  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    
    - name: Deploy Server Backend
      uses: kciter/aws-ecr-action@v4
      with:
        access_key_id: ${{ secrets.AWS_ACCESS_KEY_ID }}
        secret_access_key:  ${{ secrets.AWS_SECRET_ACCESS_KEY }}
        account_id: ${{ secrets.AWS_ID }}
        repo: osrsevents-server
        tags: latest
        region: us-east-2
        dockerfile: ./server/Dockerfile
        path: ./server
        
